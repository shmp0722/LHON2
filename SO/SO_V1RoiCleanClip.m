%% SO_V1RoiCleanClip.m
%  clean and clip V1 ROI
%% Set directory
% homeDir
homeDir = '/biac4/wandell/biac2/wandell/data/DWI-Tamagawa-Japan';

% subs in colum
subJ = {...
    'JMD1-MM-20121025-DWI'...
    'JMD2-KK-20121025-DWI'...
    'JMD3-AK-20121026-DWI'...
    'JMD4-AM-20121026-DWI'...
    'JMD5-KK-20121220-DWI'...
    'JMD6-NO-20121220-DWI'...
    'JMD7-YN-20130621-DWI'...
    'JMD8-HT-20130621-DWI'...
    'JMD9-TY-20130621-DWI'...
    'LHON1-TK-20121130-DWI'...
    'LHON2-SO-20121130-DWI'...
    'LHON3-TO-20121130-DWI'...
    'LHON4-GK-20121130-DWI'...
    'LHON5-HS-20121220-DWI'...
    'LHON6-SS-20121221-DWI'...
    'JMD-Ctl-MT-20121025-DWI'...
    'JMD-Ctl-YM-20121025-DWI'...
    'JMD-Ctl-SY-20130222DWI'...
    'JMD-Ctl-HH-20120907DWI'...
    'JMD-Ctl-HT-20120907-DWI'...
    };

%  loop subject
for i = 1:length(subJ)
%     dt= fullfile(AFQdata,subs{i},'/dwi_2nd','dt6.mat');
%     fgDir  = fullfile(AFQdata,subs{i},'/dwi_2nd/fibers');
    RoiDir = fullfile(homeDir,subJ{i},'/dwi_2nd/ROIs');
    roiF = {'lh_V1_smooth3mm.mat','rh_V1_smooth3mm.mat'};
    
    for k = 1:length(roiF)
    % load Roi
    cd(RoiDir)
    roi = dtiReadRoi(roiF{k});
    
    % Clip the Roi
    apClip = [-120,-60];
    [~, roiNot] = dtiRoiClip(roi, [], apClip, []);
    % Clean the Roi
    roi = dtiRoiClean(roiNot,0,['fillholes', 'dilate', 'removesat']);
    
    dtiWriteRoi(roi,roi.name)
    end
end
